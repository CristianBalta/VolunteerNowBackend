ñ
kF:\faculta\ANIII\Valean\GitHubProj\II_2020_Backend\backendapi\backendapi\Controllers\DonationsController.cs
	namespace		 	

backendapi		
 
.		 
Controllers		  
{

 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
DonationsController $
:% &
ControllerBase' 5
{ 
private 
readonly 
DonationsService )
_donationsService* ;
;; <
public 
DonationsController "
(" #
DonationsService# 3
donationService4 C
)C D
{ 	
_donationsService 
= 
donationService  /
;/ 0
} 	
[ 	
HttpGet	 
] 
public 
ActionResult 
< 
List  
<  !
	Donations! *
>* +
>+ ,
Get- 0
(0 1
)1 2
=>3 5
_donationsService6 G
.G H
GetH K
(K L
)L M
;M N
[ 	
HttpGet	 
( 
$str "
," #
Name$ (
=) *
$str+ 8
)8 9
]9 :
public 
ActionResult 
< 
	Donations %
>% &
Get' *
(* +
string+ 1
id2 4
)4 5
{ 	
var 
	donations 
= 
_donationsService -
.- .
GetDonation. 9
(9 :
id: <
)< =
;= >
if   
(   
	donations   
==   
null   !
)  ! "
{!! 
return"" 
NotFound"" 
(""  
)""  !
;""! "
}## 
return%% 
	donations%% 
;%% 
}&& 	
[)) 	
HttpPut))	 
()) 
$str)) "
)))" #
]))# $
public** 
ActionResult** 
<** 
	Donations** %
>**% &
UpdateDonation**' 5
(**5 6
string**6 <
id**= ?
,**? @
[**@ A
FromBody**A I
]**I J
	Donations**K T
	donations**U ^
)**^ _
{++ 	
var-- 
DonationCheck-- 
=-- 
_donationsService--  1
.--1 2
GetDonation--2 =
(--= >
id--> @
)--@ A
;--A B
if.. 
(.. 
DonationCheck.. 
==.. 
null..  $
)..$ %
{// 
return00 
NotFound00 
(00  
)00  !
;00! "
}11 
_donationsService33 
.33 
UpdateDonation33 ,
(33, -
id33- /
,33/ 0
	donations331 :
)33: ;
;33; <
return44 
	NoContent44 
(44 
)44 
;44 
}55 	
}88 
}99 Çë
gF:\faculta\ANIII\Valean\GitHubProj\II_2020_Backend\backendapi\backendapi\Controllers\NeedsController.cs
	namespace 	

backendapi
 
. 
Controllers  
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
NeedsController  
:! "
ControllerBase# 1
{ 
private 
readonly 
NeedService $
_needsService% 2
;2 3
private 
readonly 
UserService $
_userService% 1
;1 2
public 
NeedsController 
( 
NeedService *
needService+ 6
,6 7
UserService8 C
userServiceD O
)O P
{ 	
_needsService 
= 
needService '
;' (
_userService 
= 
userService &
;& '
} 	
[ 	
HttpGet	 
( 
$str 1
)1 2
]2 3
public 
ActionResult 
< 
List  
<  !
EditNeedDTO! ,
>, -
>- .
Get/ 2
(2 3
string3 9
id: <
)< =
{   	
List"" 
<"" 
EditNeedDTO"" 
>"" 
ListUnassignedDTO"" /
=""0 1
new""2 5
List""6 :
<"": ;
EditNeedDTO""; F
>""F G
(""G H
)""H I
;""I J
var## 
user## 
=## 
_userService## #
.### $
GetUser##$ +
(##+ ,
id##, .
)##. /
;##/ 0
if%% 
(%% 
user%% 
==%% 
null%% 
)%% 
{&& 
return'' 
NotFound'' 
(''  
)''  !
;''! "
}(( 
ISet** 
<** 
ObjectId** 
>** 
AssignedNeedsSet** +
=**, -
new**. 1
HashSet**2 9
<**9 :
ObjectId**: B
>**B C
(**C D
user**D H
.**H I
NeedsIds**I Q
)**Q R
;**R S
_needsService,, 
.,, 
Get,, 
(,, 
),, 
.,,  
ForEach,,  '
(,,' (
need,,( ,
=>,,- /
{-- 
if.. 
(.. 
!.. 
AssignedNeedsSet.. &
...& '
Contains..' /
(../ 0
new..0 3
ObjectId..4 <
(..< =
need..= A
...A B
Id..B D
)..D E
)..E F
&&..G I
need..J N
...N O
State..O T
==..U W
Utils..X ]
...] ^
Utils..^ c
...c d!
NEED_STATE_UNASSIGNED..d y
)..y z
{// 
EditNeedDTO00  
EDT00! $
=00% &
new00' *
EditNeedDTO00+ 6
(006 7
)007 8
{11 
Title22 
=22  
need22" &
.22& '
Title22' ,
,22, -
Description33 $
=33% &
need33' +
.33+ ,
Description33, 7
,337 8
Date44 
=44 
need44  $
.44$ %
Date44% )
,44) *
State55 
=55  
need55" &
.55& '
State55' ,
,55, -
City66 
=66  
user66! %
.66% &
Address66& -
,66- .
Id77 
=77 
need77 "
.77" #
Id77# %
}88 
;88 
ListUnassignedDTO99 &
.99& '
Add99' *
(99* +
EDT99+ .
)99. /
;99/ 0
}:: 
}<< 
)<< 
;<< 
return>> 
ListUnassignedDTO>> $
;>>$ %
}?? 	
[BB 	
HttpGetBB	 
(BB 
$strBB *
,BB* +
NameBB, 0
=BB1 2
$strBB3 <
)BB< =
]BB= >
publicCC 
ActionResultCC 
<CC 
EditNeedDTOCC '
>CC' (
GetNeedCC) 0
(CC0 1
stringCC1 7
idCC8 :
)CC: ;
{DD 	
varEE 
needEE 
=EE 
_needsServiceEE $
.EE$ %
GetNeedEE% ,
(EE, -
idEE- /
)EE/ 0
;EE0 1
ifFF 
(FF 
needFF 
==FF 
nullFF 
)FF 
{GG 
returnHH 
NotFoundHH 
(HH  
)HH  !
;HH! "
}II 
varJJ 
UserNeedJJ 
=JJ 
_userServiceJJ '
.JJ' (
GetUserJJ( /
(JJ/ 0
needJJ0 4
.JJ4 5
UserIdJJ5 ;
.JJ; <
ToStringJJ< D
(JJD E
)JJE F
)JJF G
;JJG H
ifMM 
(MM 
UserNeedMM 
==MM 
nullMM  
)MM  !
{NN 
returnOO 
NotFoundOO 
(OO  
)OO  !
;OO! "
}PP 
EditNeedDTORR 
needDTORR 
=RR  !
newRR" %
EditNeedDTORR& 1
{SS 
TitleTT 
=TT 
needTT 
.TT 
TitleTT "
,TT" #
DescriptionUU 
=UU 
needUU "
.UU" #
DescriptionUU# .
,UU. /
DateVV 
=VV 
needVV 
.VV 
DateVV  
,VV  !
StateWW 
=WW 
needWW 
.WW 
StateWW "
,WW" #
CityXX 
=XX 
UserNeedXX 
.XX  
AddressXX  '
}YY 
;YY 
return[[ 
needDTO[[ 
;[[ 
}\\ 	
[^^ 	
HttpGet^^	 
(^^ 
$str^^ "
,^^" #
Name^^$ (
=^^) *
$str^^+ 5
)^^5 6
]^^6 7
public__ 
ActionResult__ 
<__ 
List__  
<__  !
Need__! %
>__% &
>__& '
GetNeeds__( 0
(__0 1
string__1 7
id__8 :
)__: ;
{`` 	
returnbb 
_needsServicebb  
.bb  !
GetNeedsByUserbb! /
(bb/ 0
idbb0 2
)bb2 3
;bb3 4
}cc 	
[ee 	
HttpGetee	 
(ee 
$stree *
,ee* +
Nameee, 0
=ee1 2
$stree3 A
)eeA B
]eeB C
publicff 
ActionResultff 
<ff 
Listff  
<ff  !
Needff! %
>ff% &
>ff& '
GetDoneNeedsff( 4
(ff4 5
stringff5 ;
idff< >
)ff> ?
{gg 	
returnii 
_needsServiceii  
.ii  !
GetDoneNeedsByUserii! 3
(ii3 4
idii4 6
)ii6 7
;ii7 8
}jj 	
[ll 	
HttpPutll	 
(ll 
$strll "
)ll" #
]ll# $
publicmm 
ActionResultmm 
<mm 
Needmm  
>mm  !

UpdateNeedmm" ,
(mm, -
stringmm- 3
idmm4 6
,mm6 7
[mm8 9
FromBodymm9 A
]mmA B
NeedmmC G
needmmH L
)mmL M
{nn 	
varpp 
	NeedCheckpp 
=pp 
_needsServicepp )
.pp) *
GetNeedpp* 1
(pp1 2
idpp2 4
)pp4 5
;pp5 6
ifqq 
(qq 
	NeedCheckqq 
==qq 
nullqq !
)qq! "
{rr 
returnss 
NotFoundss 
(ss  
)ss  !
;ss! "
}tt 
needuu 
.uu 
Iduu 
=uu 
iduu 
;uu 
needvv 
.vv 
UserIdvv 
=vv 
	NeedCheckvv #
.vv# $
UserIdvv$ *
;vv* +
needww 
.ww 
Dateww 
=ww 
	NeedCheckww !
.ww! "
Dateww" &
;ww& '
needxx 
.xx 
Statexx 
=xx 
	NeedCheckxx "
.xx" #
Statexx# (
;xx( )
_needsServiceyy 
.yy 

UpdateNeedyy $
(yy$ %
idyy% '
,yy' (
needyy) -
)yy- .
;yy. /
returnzz 
	NoContentzz 
(zz 
)zz 
;zz 
}{{ 	
[ 	
HttpPost	 
( 
$str #
)# $
]$ %
public
ÄÄ 
ActionResult
ÄÄ 
<
ÄÄ 
Need
ÄÄ  
>
ÄÄ  !
Create
ÄÄ" (
(
ÄÄ( )
string
ÄÄ) /
id
ÄÄ0 2
,
ÄÄ2 3
[
ÄÄ4 5
FromBody
ÄÄ5 =
]
ÄÄ= >
NeedCreateDTO
ÄÄ? L
NeedDTO
ÄÄM T
)
ÄÄT U
{
ÅÅ 	
Need
ÉÉ 
NeedCreated
ÉÉ 
=
ÉÉ 
new
ÉÉ "
Need
ÉÉ# '
{
ÑÑ 
Title
ÖÖ 
=
ÖÖ 
NeedDTO
ÖÖ 
.
ÖÖ  
Title
ÖÖ  %
,
ÖÖ% &
Description
ÜÜ 
=
ÜÜ 
NeedDTO
ÜÜ %
.
ÜÜ% &
Description
ÜÜ& 1
,
ÜÜ1 2
UserId
áá 
=
áá 
ObjectId
áá !
.
áá! "
Parse
áá" '
(
áá' (
id
áá( *
)
áá* +
,
áá+ ,
Date
àà 
=
àà 
DateTime
àà 
.
àà  
Now
àà  #
.
àà# $
ToString
àà$ ,
(
àà, -
$str
àà- B
)
ààB C
,
ààC D
State
ââ 
=
ââ 
Utils
ââ 
.
ââ 
Utils
ââ #
.
ââ# $#
NEED_STATE_UNASSIGNED
ââ$ 9
}
ää 
;
ää 
_needsService
åå 
.
åå 

CreateNeed
åå $
(
åå$ %
NeedCreated
åå% 0
)
åå0 1
;
åå1 2
return
çç 
CreatedAtRoute
çç !
(
çç! "
$str
çç" +
,
çç+ ,
new
çç- 0
{
çç1 2
id
çç3 5
=
çç6 7
NeedCreated
çç8 C
.
ççC D
Id
ççD F
.
ççF G
ToString
ççG O
(
ççO P
)
ççP Q
}
ççR S
,
ççS T
NeedCreated
ççU `
)
çç` a
;
çça b
}
éé 	
[
êê 	

HttpDelete
êê	 
(
êê 
$str
êê %
)
êê% &
]
êê& '
public
ëë 
ActionResult
ëë 
<
ëë 
Need
ëë  
>
ëë  !

DeleteNeed
ëë" ,
(
ëë, -
string
ëë- 3
id
ëë4 6
)
ëë6 7
{
íí 	
var
îî 
	NeedCheck
îî 
=
îî 
_needsService
îî )
.
îî) *
GetNeed
îî* 1
(
îî1 2
id
îî2 4
)
îî4 5
;
îî5 6
if
ïï 
(
ïï 
	NeedCheck
ïï 
==
ïï 
null
ïï !
)
ïï! "
{
ññ 
return
óó 
NotFound
óó 
(
óó  
)
óó  !
;
óó! "
}
òò 
_needsService
öö 
.
öö 

DeleteNeed
öö $
(
öö$ %
id
öö% '
)
öö' (
;
öö( )
return
õõ 
	NoContent
õõ 
(
õõ 
)
õõ 
;
õõ 
}
úú 	
[
ûû 	
HttpGet
ûû	 
(
ûû 
$str
ûû /
,
ûû/ 0
Name
ûû1 5
=
ûû6 7
$str
ûû8 J
)
ûûJ K
]
ûûK L
public
üü 
ActionResult
üü 
<
üü 
List
üü  
<
üü  !
EditNeedDTO
üü! ,
>
üü, -
>
üü- .
GetAssignedNeeds
üü/ ?
(
üü? @
string
üü@ F
id
üüG I
)
üüI J
{
†† 	
var
°° 
user
°° 
=
°° 
_userService
°° #
.
°°# $
GetUser
°°$ +
(
°°+ ,
id
°°, .
)
°°. /
;
°°/ 0
if
¢¢ 
(
¢¢ 
user
¢¢ 
==
¢¢ 
null
¢¢ 
)
¢¢ 
{
££ 
return
§§ 
NotFound
§§ 
(
§§  
)
§§  !
;
§§! "
}
•• 
List
ßß 
<
ßß 
EditNeedDTO
ßß 
>
ßß 
ListOfAssigned
ßß ,
=
ßß- .
new
ßß/ 2
List
ßß3 7
<
ßß7 8
EditNeedDTO
ßß8 C
>
ßßC D
(
ßßD E
)
ßßE F
;
ßßF G
System
®® 
.
®® 
Diagnostics
®® 
.
®® 
Debug
®® $
.
®®$ %
	WriteLine
®®% .
(
®®. /
user
®®/ 3
.
®®3 4
NeedsIds
®®4 <
.
®®< =
Count
®®= B
)
®®B C
;
®®C D
user
™™ 
.
™™ 
NeedsIds
™™ 
.
™™ 
ForEach
™™ !
(
™™! "
id
™™" $
=>
™™% '
{
´´ 
var
¨¨ 
need
¨¨ 
=
¨¨ 
_needsService
¨¨ (
.
¨¨( )
GetNeed
¨¨) 0
(
¨¨0 1
id
¨¨1 3
.
¨¨3 4
ToString
¨¨4 <
(
¨¨< =
)
¨¨= >
)
¨¨> ?
;
¨¨? @
if
≠≠ 
(
≠≠ 
need
≠≠ 
!=
≠≠ 
null
≠≠  
&&
≠≠! #
need
≠≠$ (
.
≠≠( )
State
≠≠) .
==
≠≠/ 1
Utils
≠≠2 7
.
≠≠7 8
Utils
≠≠8 =
.
≠≠= >!
NEED_STATE_ASSIGNED
≠≠> Q
)
≠≠Q R
{
ÆÆ 
EditNeedDTO
ØØ 
NeedDTO
ØØ  '
=
ØØ( )
new
ØØ* -
EditNeedDTO
ØØ. 9
{
∞∞ 
Description
±± #
=
±±$ %
need
±±& *
.
±±* +
Description
±±+ 6
,
±±6 7
Date
≤≤ 
=
≤≤ 
need
≤≤ #
.
≤≤# $
Date
≤≤$ (
,
≤≤( )
Title
≥≥ 
=
≥≥ 
need
≥≥  $
.
≥≥$ %
Title
≥≥% *
,
≥≥* +
State
¥¥ 
=
¥¥ 
need
¥¥  $
.
¥¥$ %
State
¥¥% *
,
¥¥* +
City
µµ 
=
µµ 
user
µµ #
.
µµ# $
Address
µµ$ +
,
µµ+ ,
Id
∂∂ 
=
∂∂ 
need
∂∂ !
.
∂∂! "
Id
∂∂" $
}
∏∏ 
;
∏∏ 
ListOfAssigned
ππ "
.
ππ" #
Add
ππ# &
(
ππ& '
NeedDTO
ππ' .
)
ππ. /
;
ππ/ 0
}
∫∫ 
}
ºº 
)
ΩΩ 
;
ΩΩ 
return
øø 
ListOfAssigned
øø !
;
øø! "
}
¿¿ 	
[
√√ 	
HttpGet
√√	 
(
√√ 
$str
√√ +
,
√√+ ,
Name
√√- 1
=
√√2 3
$str
√√4 K
)
√√K L
]
√√L M
public
ƒƒ 
ActionResult
ƒƒ 
<
ƒƒ 
List
ƒƒ  
<
ƒƒ  !
EditNeedDTO
ƒƒ! ,
>
ƒƒ, -
>
ƒƒ- .#
GetDoneVolunteerNeeds
ƒƒ/ D
(
ƒƒD E
string
ƒƒE K
id
ƒƒL N
)
ƒƒN O
{
≈≈ 	
var
∆∆ 
user
∆∆ 
=
∆∆ 
_userService
∆∆ #
.
∆∆# $
GetUser
∆∆$ +
(
∆∆+ ,
id
∆∆, .
)
∆∆. /
;
∆∆/ 0
if
«« 
(
«« 
user
«« 
==
«« 
null
«« 
)
«« 
{
»» 
return
…… 
NotFound
…… 
(
……  
)
……  !
;
……! "
}
   
List
ÃÃ 
<
ÃÃ 
EditNeedDTO
ÃÃ 
>
ÃÃ 

ListOfDone
ÃÃ (
=
ÃÃ) *
new
ÃÃ+ .
List
ÃÃ/ 3
<
ÃÃ3 4
EditNeedDTO
ÃÃ4 ?
>
ÃÃ? @
(
ÃÃ@ A
)
ÃÃA B
;
ÃÃB C
System
ÕÕ 
.
ÕÕ 
Diagnostics
ÕÕ 
.
ÕÕ 
Debug
ÕÕ $
.
ÕÕ$ %
	WriteLine
ÕÕ% .
(
ÕÕ. /
user
ÕÕ/ 3
.
ÕÕ3 4
NeedsIds
ÕÕ4 <
.
ÕÕ< =
Count
ÕÕ= B
)
ÕÕB C
;
ÕÕC D
user
œœ 
.
œœ 
NeedsIds
œœ 
.
œœ 
ForEach
œœ !
(
œœ! "
id
œœ" $
=>
œœ% '
{
–– 
var
—— 
need
—— 
=
—— 
_needsService
—— (
.
——( )
GetNeed
——) 0
(
——0 1
id
——1 3
.
——3 4
ToString
——4 <
(
——< =
)
——= >
)
——> ?
;
——? @
if
““ 
(
““ 
need
““ 
!=
““ 
null
““  
&&
““! #
need
““$ (
.
““( )
State
““) .
==
““/ 1
Utils
““2 7
.
““7 8
Utils
““8 =
.
““= >
NEED_STATE_DONE
““> M
)
““M N
{
”” 
EditNeedDTO
‘‘ 
NeedDTO
‘‘  '
=
‘‘( )
new
‘‘* -
EditNeedDTO
‘‘. 9
{
’’ 
Description
÷÷ #
=
÷÷$ %
need
÷÷& *
.
÷÷* +
Description
÷÷+ 6
,
÷÷6 7
Date
◊◊ 
=
◊◊ 
need
◊◊ #
.
◊◊# $
Date
◊◊$ (
,
◊◊( )
Title
ÿÿ 
=
ÿÿ 
need
ÿÿ  $
.
ÿÿ$ %
Title
ÿÿ% *
,
ÿÿ* +
State
ŸŸ 
=
ŸŸ 
need
ŸŸ  $
.
ŸŸ$ %
State
ŸŸ% *
,
ŸŸ* +
City
⁄⁄ 
=
⁄⁄ 
user
⁄⁄ #
.
⁄⁄# $
Address
⁄⁄$ +
,
⁄⁄+ ,
Id
€€ 
=
€€ 
need
€€ !
.
€€! "
Id
€€" $
}
›› 
;
›› 

ListOfDone
ﬁﬁ 
.
ﬁﬁ 
Add
ﬁﬁ "
(
ﬁﬁ" #
NeedDTO
ﬁﬁ# *
)
ﬁﬁ* +
;
ﬁﬁ+ ,
}
ﬂﬂ 
}
·· 
)
‚‚ 
;
‚‚ 
return
‰‰ 

ListOfDone
‰‰ 
;
‰‰ 
}
ÂÂ 	
}
ÁÁ 
}ËË ‰~
gF:\faculta\ANIII\Valean\GitHubProj\II_2020_Backend\backendapi\backendapi\Controllers\UsersController.cs
	namespace 	

backendapi
 
. 
Controllers  
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
UsersController  
:! "
ControllerBase# 1
{ 
private 
readonly 
UserService $
_userService% 1
;1 2
private 
readonly 
NeedService $
_needService% 1
;1 2
public 
UsersController 
( 
UserService *
userService+ 6
,6 7
NeedService8 C
needServiceD O
)O P
{ 	
_userService 
= 
userService &
;& '
_needService 
= 
needService &
;& '
} 	
[ 	
HttpGet	 
] 
public 
ActionResult 
< 
List  
<  !
User! %
>% &
>& '
Get( +
(+ ,
), -
=>. 0
_userService1 =
.= >
Get> A
(A B
)B C
;C D
[   	
HttpPost  	 
]   
[!! 	
Route!!	 
(!! 
$str!! 
)!! 
]!! 
public"" 
ActionResult"" 
<"" 
string"" "
>""" #
Create""$ *
(""* +
User""+ /
user""0 4
)""4 5
{## 	
var$$ 
	userCheck$$ 
=$$ 
_userService$$ (
.$$( )
GetUserByEmail$$) 7
($$7 8
user$$8 <
.$$< =
Email$$= B
)$$B C
;$$C D
if&& 
(&& 
	userCheck&& 
!=&& 
null&& !
)&&! "
{'' 
return(( 
NotFound(( 
(((  
)((  !
;((! "
})) 
_userService** 
.** 
Create** 
(**  
user**  $
)**$ %
;**% &
CreatedAtRoute++ 
(++ 
$str++ $
,++$ %
new++& )
{++* +
id++, .
=++/ 0
user++1 5
.++5 6
Id++6 8
.++8 9
ToString++9 A
(++A B
)++B C
}++D E
,++E F
user++G K
)++K L
;++L M
LoginUserDTO-- 
loginUserDTO-- %
=--& '
new--( +
LoginUserDTO--, 8
{.. 
Id// 
=// 
user// 
.// 
Id// 
,// 
Type00 
=00 
user00 
.00 
Type00  
,00  !
}22 
;22 
return44 
UserService44 
.44 
SerialGenerator44 .
(44. /
loginUserDTO44/ ;
)44; <
;44< =
}66 	
[88 	
HttpGet88	 
(88 
$str88 *
,88* +
Name88, 0
=881 2
$str883 <
)88< =
]88= >
public99 
ActionResult99 
<99 
EditUserDTO99 '
>99' (
GetUser99) 0
(990 1
string991 7
id998 :
)99: ;
{:: 	
var;; 
user;; 
=;; 
_userService;; #
.;;# $
GetUser;;$ +
(;;+ ,
id;;, .
);;. /
;;;/ 0
EditUserDTO== 
UserDTO== 
;==  
if>> 
(>> 
user>> 
==>> 
null>> 
)>> 
{?? 
return@@ 
NotFound@@ 
(@@  
)@@  !
;@@! "
}AA 
elseBB 
{CC 
UserDTODD 
=DD 
newDD 
EditUserDTODD )
{EE 
LastnameFF 
=FF 
userFF #
.FF# $
LastnameFF$ ,
,FF, -
	FirstnameGG 
=GG 
userGG  $
.GG$ %
	FirstnameGG% .
,GG. /
EmailHH 
=HH 
userHH  
.HH  !
EmailHH! &
,HH& '
	TelephoneII 
=II 
userII  $
.II$ %
	TelephoneII% .
,II. /
AddressJJ 
=JJ 
userJJ "
.JJ" #
AddressJJ# *
,JJ* +
}LL 
;LL 
}MM 
returnOO 
UserDTOOO 
;OO 
}PP 	
[RR 	
HttpGetRR	 
(RR 
$strRR "
,RR" #
NameRR$ (
=RR) *
$strRR+ 8
)RR8 9
]RR9 :
publicSS 
ActionResultSS 
<SS 
ListSS  
<SS  !
MongoDBSS! (
.SS( )
BsonSS) -
.SS- .
ObjectIdSS. 6
>SS6 7
>SS7 8
GetSS9 <
(SS< =
stringSS= C
idSSD F
)SSF G
{TT 	
varUU 
ListsIdsUU 
=UU 
_userServiceUU '
.UU' (
GetUserNeedsIdsUU( 7
(UU7 8
idUU8 :
)UU: ;
;UU; <
ifWW 
(WW 
ListsIdsWW 
==WW 
nullWW  
)WW  !
{XX 
returnYY 
NotFoundYY 
(YY  
)YY  !
;YY! "
}ZZ 
return]] 
ListsIds]] 
;]] 
}^^ 	
[`` 	
HttpPut``	 
(`` 
$str`` -
,``- .
Name``/ 3
=``4 5
$str``6 B
)``B C
]``C D
publicaa 
ActionResultaa 
<aa 
Useraa  
>aa  !

UpdateUseraa" ,
(aa, -
stringaa- 3
idaa4 6
,aa6 7
[aa8 9
FromBodyaa9 A
]aaA B
UseraaC G
useraaH L
)aaL M
{bb 	
varcc 
	UserCheckcc 
=cc 
_userServicecc (
.cc( )
GetUsercc) 0
(cc0 1
idcc1 3
)cc3 4
;cc4 5
ifee 
(ee 
	UserCheckee 
==ee 
nullee !
)ee! "
{ff 
returngg 
NotFoundgg 
(gg  
)gg  !
;gg! "
}hh 
userjj 
.jj 
Idjj 
=jj 
idjj 
;jj 
userkk 
.kk 
Passwordkk 
=kk 
	UserCheckkk %
.kk% &
Passwordkk& .
;kk. /
userll 
.ll 
Typell 
=ll 
	UserCheckll !
.ll! "
Typell" &
;ll& '
usermm 
.mm 
NeedsIdsmm 
=mm 
	UserCheckmm %
.mm% &
NeedsIdsmm& .
;mm. /
_userServicepp 
.pp 

UpdateUserpp #
(pp# $
idpp$ &
,pp& '
userpp( ,
)pp, -
;pp- .
returnqq 
	NoContentqq 
(qq 
)qq 
;qq 
}rr 	
[tt 	
HttpPuttt	 
(tt 
$strtt ;
,tt; <
Namett= A
=ttB C
$strttD T
)ttT U
]ttU V
publicuu 
ActionResultuu 
<uu 
Useruu  
>uu  !
AssignUserNeeduu" 0
(uu0 1
stringuu1 7
uiduu8 ;
,uu; <
[uu= >
FromRouteAttributeuu> P
]uuP Q
stringuuR X
niduuY \
)uu\ ]
{vv 	
varww 
	UserCheckww 
=ww 
_userServiceww (
.ww( )
GetUserww) 0
(ww0 1
uidww1 4
)ww4 5
;ww5 6
ifxx 
(xx 
	UserCheckxx 
==xx 
nullxx !
)xx! "
{yy 
returnzz 
NotFoundzz 
(zz  
)zz  !
;zz! "
}{{ 
ObjectId|| 
nidy|| 
=|| 
new|| 
ObjectId||  (
(||( )
nid||) ,
)||, -
;||- .
List~~ 
<~~ 
Need~~ 
>~~ 
ListOfAssigned~~ %
=~~& '
new~~( +
List~~, 0
<~~0 1
Need~~1 5
>~~5 6
(~~6 7
)~~7 8
;~~8 9
	UserCheck 
. 
NeedsIds 
. 
ForEach &
(& '
uid' *
=>+ -
{
ÄÄ 
var
ÅÅ 
need
ÅÅ 
=
ÅÅ 
_needService
ÅÅ '
.
ÅÅ' (
GetNeed
ÅÅ( /
(
ÅÅ/ 0
uid
ÅÅ0 3
.
ÅÅ3 4
ToString
ÅÅ4 <
(
ÅÅ< =
)
ÅÅ= >
)
ÅÅ> ?
;
ÅÅ? @
ListOfAssigned
ÇÇ 
.
ÇÇ 
Add
ÇÇ "
(
ÇÇ" #
need
ÇÇ# '
)
ÇÇ' (
;
ÇÇ( )
}
ÉÉ 
)
ÑÑ 
;
ÑÑ 
var
ÜÜ 
NeedGet
ÜÜ 
=
ÜÜ 
_needService
ÜÜ &
.
ÜÜ& '
GetNeed
ÜÜ' .
(
ÜÜ. /
nid
ÜÜ/ 2
)
ÜÜ2 3
;
ÜÜ3 4
NeedGet
áá 
.
áá 
State
áá 
=
áá 
Utils
áá !
.
áá! "
Utils
áá" '
.
áá' (!
NEED_STATE_ASSIGNED
áá( ;
;
áá; <
if
àà 
(
àà 
NeedGet
àà 
==
àà 
null
àà 
)
àà  
{
ââ 
return
ää 
NotFound
ää 
(
ää  
)
ää  !
;
ää! "
}
ãã 
	UserCheck
çç 
.
çç 
NeedsIds
çç 
.
çç 
Add
çç "
(
çç" #
nidy
çç# '
)
çç' (
;
çç( )
_needService
éé 
.
éé 

UpdateNeed
éé #
(
éé# $
nid
éé$ '
,
éé' (
NeedGet
éé) 0
)
éé0 1
;
éé1 2
_userService
èè 
.
èè 
AssignUserNeed
èè '
(
èè' (
uid
èè( +
,
èè+ ,
nidy
èè- 1
,
èè1 2
	UserCheck
èè3 <
)
èè< =
;
èè= >
return
êê 
	NoContent
êê 
(
êê 
)
êê 
;
êê 
}
ëë 	
[
ìì 	
HttpPut
ìì	 
(
ìì 
$str
ìì =
,
ìì= >
Name
ìì? C
=
ììD E
$str
ììF X
)
ììX Y
]
ììY Z
public
îî 
ActionResult
îî 
<
îî 
User
îî  
>
îî  !
UnassignUserNeed
îî" 2
(
îî2 3
string
îî3 9
uid
îî: =
,
îî= >
[
îî? @ 
FromRouteAttribute
îî@ R
]
îîR S
string
îîT Z
nid
îî[ ^
)
îî^ _
{
ïï 	
var
ññ 
	UserCheck
ññ 
=
ññ 
_userService
ññ (
.
ññ( )
GetUser
ññ) 0
(
ññ0 1
uid
ññ1 4
)
ññ4 5
;
ññ5 6
if
óó 
(
óó 
	UserCheck
óó 
==
óó 
null
óó !
)
óó! "
{
òò 
return
ôô 
NotFound
ôô 
(
ôô  
)
ôô  !
;
ôô! "
}
öö 
ObjectId
õõ 
nidy
õõ 
=
õõ 
new
õõ 
ObjectId
õõ  (
(
õõ( )
nid
õõ) ,
)
õõ, -
;
õõ- .
var
ùù 
NeedGet
ùù 
=
ùù 
_needService
ùù &
.
ùù& '
GetNeed
ùù' .
(
ùù. /
nid
ùù/ 2
)
ùù2 3
;
ùù3 4
NeedGet
ûû 
.
ûû 
State
ûû 
=
ûû 
Utils
ûû !
.
ûû! "
Utils
ûû" '
.
ûû' (#
NEED_STATE_UNASSIGNED
ûû( =
;
ûû= >
if
üü 
(
üü 
NeedGet
üü 
==
üü 
null
üü 
)
üü  
{
†† 
return
°° 
NotFound
°° 
(
°°  
)
°°  !
;
°°! "
}
¢¢ 
	UserCheck
§§ 
.
§§ 
NeedsIds
§§ 
.
§§ 
Remove
§§ %
(
§§% &
nidy
§§& *
)
§§* +
;
§§+ ,
_needService
•• 
.
•• 

UpdateNeed
•• #
(
••# $
nid
••$ '
,
••' (
NeedGet
••) 0
)
••0 1
;
••1 2
_userService
¶¶ 
.
¶¶ 
AssignUserNeed
¶¶ '
(
¶¶' (
uid
¶¶( +
,
¶¶+ ,
nidy
¶¶- 1
,
¶¶1 2
	UserCheck
¶¶3 <
)
¶¶< =
;
¶¶= >
return
ßß 
	NoContent
ßß 
(
ßß 
)
ßß 
;
ßß 
}
®® 	
[
™™ 	
HttpPut
™™	 
(
™™ 
$str
™™ 9
,
™™9 :
Name
™™; ?
=
™™@ A
$str
™™B P
)
™™P Q
]
™™Q R
public
´´ 
ActionResult
´´ 
<
´´ 
User
´´  
>
´´  !
DoneUserNeed
´´" .
(
´´. /
string
´´/ 5
uid
´´6 9
,
´´9 :
[
´´; < 
FromRouteAttribute
´´< N
]
´´N O
string
´´P V
nid
´´W Z
)
´´Z [
{
¨¨ 	
var
ÆÆ 
NeedGet
ÆÆ 
=
ÆÆ 
_needService
ÆÆ &
.
ÆÆ& '
GetNeed
ÆÆ' .
(
ÆÆ. /
nid
ÆÆ/ 2
)
ÆÆ2 3
;
ÆÆ3 4
NeedGet
ØØ 
.
ØØ 
State
ØØ 
=
ØØ 
Utils
ØØ !
.
ØØ! "
Utils
ØØ" '
.
ØØ' (
NEED_STATE_DONE
ØØ( 7
;
ØØ7 8
if
∞∞ 
(
∞∞ 
NeedGet
∞∞ 
==
∞∞ 
null
∞∞ 
)
∞∞  
{
±± 
return
≤≤ 
NotFound
≤≤ 
(
≤≤  
)
≤≤  !
;
≤≤! "
}
≥≥ 
_needService
µµ 
.
µµ 

UpdateNeed
µµ #
(
µµ# $
nid
µµ$ '
,
µµ' (
NeedGet
µµ) 0
)
µµ0 1
;
µµ1 2
return
∂∂ 
	NoContent
∂∂ 
(
∂∂ 
)
∂∂ 
;
∂∂ 
}
∑∑ 	
[
ππ 	
HttpPost
ππ	 
]
ππ 
[
∫∫ 	
Route
∫∫	 
(
∫∫ 
$str
∫∫ 
)
∫∫ 
]
∫∫ 
public
ºº 
ActionResult
ºº 
<
ºº 
string
ºº "
>
ºº" #
Login
ºº$ )
(
ºº) *
User
ºº* .
user
ºº/ 3
)
ºº3 4
{
ΩΩ 	
var
øø 
status
øø 
=
øø 
_userService
øø %
.
øø% &
Login
øø& +
(
øø+ ,
user
øø, 0
.
øø0 1
Email
øø1 6
,
øø6 7
user
øø8 <
.
øø< =
Password
øø= E
)
øøE F
;
øøF G
if
¡¡ 
(
¡¡ 
status
¡¡ 
==
¡¡ 
null
¡¡ 
)
¡¡ 
{
¬¬ 
return
ƒƒ 
NotFound
ƒƒ 
(
ƒƒ  
)
ƒƒ  !
;
ƒƒ! "
}
≈≈ 
else
«« 
{
»» 
LoginUserDTO
…… 
loginUserDTO
…… )
=
……* +
new
……, /
LoginUserDTO
……0 <
{
   
Id
ÀÀ 
=
ÀÀ 
status
ÀÀ 
.
ÀÀ  
Id
ÀÀ  "
,
ÀÀ" #
Type
ÃÃ 
=
ÃÃ 
status
ÃÃ !
.
ÃÃ! "
Type
ÃÃ" &
,
ÃÃ& '
}
ŒŒ 
;
ŒŒ 
return
–– 
UserService
–– "
.
––" #
SerialGenerator
––# 2
(
––2 3
loginUserDTO
––3 ?
)
––? @
;
––@ A
}
—— 
}
”” 	
}
’’ 
}÷÷ π	
[F:\faculta\ANIII\Valean\GitHubProj\II_2020_Backend\backendapi\backendapi\DTO\EditNeedDTO.cs
	namespace 	

backendapi
 
. 
DTO 
{ 
public 

class 
EditNeedDTO 
{		 
public 
string 
Id 
{ 
get 
; 
set  #
;# $
}% &
public 
string 
Title 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Description !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
Date 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
State 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
City 
{ 
get  
;  !
set" %
;% &
}' (
} 
} ¨
[F:\faculta\ANIII\Valean\GitHubProj\II_2020_Backend\backendapi\backendapi\DTO\EditUserDTO.cs
	namespace 	

backendapi
 
. 
DTO 
{ 
public 

class 
EditUserDTO 
{		 
public

 
string

 
Lastname

 
{

  
get

! $
;

$ %
set

& )
;

) *
}

+ ,
public 
string 
	Firstname 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
	Telephone 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
Email 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Address 
{ 
get  #
;# $
set% (
;( )
}* +
} 
} ä
\F:\faculta\ANIII\Valean\GitHubProj\II_2020_Backend\backendapi\backendapi\DTO\LoginUserDTO.cs
	namespace 	

backendapi
 
. 
DTO 
{ 
[ 
Serializable 
] 
public		 

class		 
LoginUserDTO		 
{

 
public 
string 
Id 
{ 
get 
; 
set  #
;# $
}% &
public 
string 
Type 
{ 
get  
;  !
set" %
;% &
}' (
} 
} ﬁ
]F:\faculta\ANIII\Valean\GitHubProj\II_2020_Backend\backendapi\backendapi\DTO\NeedCreateDTO.cs
	namespace 	

backendapi
 
. 
DTO 
{ 
public 

class 
NeedCreateDTO 
{		 
public

 
string

 
Title

 
{

 
get

 !
;

! "
set

# &
;

& '
}

( )
public 
string 
Description !
{" #
get$ '
;' (
set) ,
;, -
}. /
} 
} ⁄
cF:\faculta\ANIII\Valean\GitHubProj\II_2020_Backend\backendapi\backendapi\Models\DatabaseSettings.cs
	namespace 	

backendapi
 
. 
Models 
{ 
public 

class 
DatabaseSettings !
:" #
IDatabaseSettings$ 5
{ 
public 
string 
ConnectionString &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
string 
DatabaseName "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
string 
UserCollectionName (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
public		 
string		 #
DonationsCollectionName		 -
{		. /
get		0 3
;		3 4
set		5 8
;		8 9
}		: ;
public

 
string

 
NeedCollectionName

 (
{

) *
get

+ .
;

. /
set

0 3
;

3 4
}

5 6
} 
public 

	interface 
IDatabaseSettings &
{ 
string 
UserCollectionName !
{" #
get$ '
;' (
set) ,
;, -
}. /
string #
DonationsCollectionName &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
string 
NeedCollectionName !
{" #
get$ '
;' (
set) ,
;, -
}. /
string 
ConnectionString 
{  !
get" %
;% &
set' *
;* +
}, -
string 
DatabaseName 
{ 
get !
;! "
set# &
;& '
}( )
} 
} œ
\F:\faculta\ANIII\Valean\GitHubProj\II_2020_Backend\backendapi\backendapi\Models\Donations.cs
	namespace 	

backendapi
 
. 
Models 
{		 
public

 

class

 
	Donations

 
{ 
[ 	
BsonId	 
] 
[ 	
BsonRepresentation	 
( 
BsonType $
.$ %
ObjectId% -
)- .
]. /
public 
string 
Id 
{ 
get 
; 
set  #
;# $
}% &
public 
string 
Title 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Description !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
int 
Sum 
{ 
get 
; 
set !
;! "
}# $
} 
} Ø

WF:\faculta\ANIII\Valean\GitHubProj\II_2020_Backend\backendapi\backendapi\Models\Need.cs
	namespace 	

backendapi
 
. 
Models 
{		 
public

 

class

 
Need

 
{ 
[ 	
BsonId	 
] 
[ 	
BsonRepresentation	 
( 
BsonType $
.$ %
ObjectId% -
)- .
]. /
public 
string 
Id 
{ 
get 
; 
set  #
;# $
}% &
public 
ObjectId 
UserId 
; 
public 
string 
Title 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
Description !
{" #
get$ '
;' (
set) ,
;, -
}. /
public 
string 
Date 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
State 
{ 
get !
;! "
set# &
;& '
}( )
} 
} Ö
WF:\faculta\ANIII\Valean\GitHubProj\II_2020_Backend\backendapi\backendapi\Models\User.cs
	namespace 	

backendapi
 
. 
Models 
{		 
public

 

class

 
User

 
{ 
[ 	
BsonId	 
] 
[ 	
BsonRepresentation	 
( 
BsonType $
.$ %
ObjectId% -
)- .
]. /
public 
string 
Id 
{ 
get 
; 
set  #
;# $
}% &
public 
string 
Lastname 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
string 
	Firstname 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
Email 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
	Telephone 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
Address 
{ 
get  #
;# $
set% (
;( )
}* +
public 
string 
Type 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
public 
List 
< 
ObjectId 
> 
NeedsIds &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
}!! 
}"" ´

SF:\faculta\ANIII\Valean\GitHubProj\II_2020_Backend\backendapi\backendapi\Program.cs
	namespace

 	

backendapi


 
{ 
public 

class 
Program 
{ 
public 
static 
void 
Main 
(  
string  &
[& '
]' (
args) -
)- .
{ 	
CreateHostBuilder 
( 
args "
)" #
.# $
Build$ )
() *
)* +
.+ ,
Run, /
(/ 0
)0 1
;1 2
} 	
public 
static 
IHostBuilder "
CreateHostBuilder# 4
(4 5
string5 ;
[; <
]< =
args> B
)B C
=>D F
Host 
.  
CreateDefaultBuilder %
(% &
args& *
)* +
. $
ConfigureWebHostDefaults )
() *

webBuilder* 4
=>5 7
{ 

webBuilder 
. 

UseStartup )
<) *
Startup* 1
>1 2
(2 3
)3 4
;4 5
} 
) 
; 
} 
} √
eF:\faculta\ANIII\Valean\GitHubProj\II_2020_Backend\backendapi\backendapi\Services\DonationsService.cs
	namespace 	

backendapi
 
. 
Services 
{		 
public

 

class

 
DonationsService

 !
{ 
private 
readonly 
IMongoCollection )
<) *
	Donations* 3
>3 4

_donations5 ?
;? @
public 
DonationsService 
(  
IDatabaseSettings  1
settings2 :
): ;
{ 	
var 
client 
= 
new 
MongoClient (
(( )
settings) 1
.1 2
ConnectionString2 B
)B C
;C D
var 
database 
= 
client !
.! "
GetDatabase" -
(- .
settings. 6
.6 7
DatabaseName7 C
)C D
;D E

_donations 
= 
database !
.! "
GetCollection" /
</ 0
	Donations0 9
>9 :
(: ;
settings; C
.C D#
DonationsCollectionNameD [
)[ \
;\ ]
} 	
public 
List 
< 
	Donations 
> 
Get "
(" #
)# $
=>% '

_donations 
. 
Find 
( 
donation #
=>$ &
true' +
)+ ,
., -
ToList- 3
(3 4
)4 5
;5 6
public 
	Donations 
GetDonation $
($ %
string% +
id, .
). /
=>0 2

_donations 
. 
Find 
( 
	donations %
=>& (
	donations) 2
.2 3
Id3 5
==6 8
id9 ;
); <
.< =
FirstOrDefault= K
(K L
)L M
;M N
public 
void 
UpdateDonation "
(" #
string# )
id* ,
,, -
	Donations. 7

donationIn8 B
)B C
=>D F

_donations 
. 
FindOneAndReplace (
(( )
donation) 1
=>2 4
donation5 =
.= >
Id> @
==A C
idD F
,F G

donationInH R
)R S
;S T
public 
	Donations 
CreateDonation '
(' (
	Donations( 1
donation2 :
): ;
{   	

_donations!! 
.!! 
	InsertOne!!  
(!!  !
donation!!! )
)!!) *
;!!* +
return"" 
donation"" 
;"" 
}## 	
public%% 
void%% 
DeleteDonation%% "
(%%" #
string%%# )
id%%* ,
)%%, -
=>%%. 0

_donations&& 
.&& 
	DeleteOne&&  
(&&  !
donation&&! )
=>&&* ,
donation&&- 5
.&&5 6
Id&&6 8
==&&9 ;
id&&< >
)&&> ?
;&&? @
}++ 
},, Í'
`F:\faculta\ANIII\Valean\GitHubProj\II_2020_Backend\backendapi\backendapi\Services\NeedService.cs
	namespace 	

backendapi
 
. 
Services 
{		 
public

 

class

 
NeedService

 
{ 
private 
readonly 
IMongoCollection )
<) *
Need* .
>. /
_needs0 6
;6 7
public 
NeedService 
( 
IDatabaseSettings ,
settings- 5
)5 6
{ 	
var 
client 
= 
new 
MongoClient (
(( )
settings) 1
.1 2
ConnectionString2 B
)B C
;C D
var 
database 
= 
client !
.! "
GetDatabase" -
(- .
settings. 6
.6 7
DatabaseName7 C
)C D
;D E
_needs 
= 
database 
. 
GetCollection +
<+ ,
Need, 0
>0 1
(1 2
settings2 :
.: ;
NeedCollectionName; M
)M N
;N O
} 	
public 
List 
< 
Need 
> 
Get 
( 
) 
=>  "
_needs
 
. 
Find 
( 
need 
=> 
true "
)" #
.# $
ToList$ *
(* +
)+ ,
;, -
public 
Need 
GetNeed 
( 
string "
id# %
)% &
=>' )
_needs 
. 
Find 
( 
need 
=> 
need  $
.$ %
Id% '
==( *
id+ -
)- .
.. /
FirstOrDefault/ =
(= >
)> ?
;? @
public 
Need 

CreateNeed 
( 
Need #
need$ (
)( )
{ 	
_needs 
. 
	InsertOne 
( 
need !
)! "
;" #
return   
need   
;   
}!! 	
public## 
List## 
<## 
Need## 
>## 
GetNeedsByUser## (
(##( )
string##) /
id##0 2
)##2 3
{$$ 	
MongoDB%% 
.%% 
Bson%% 
.%% 
ObjectId%% !
needsIds%%" *
=%%+ ,
new%%- 0
MongoDB%%1 8
.%%8 9
Bson%%9 =
.%%= >
ObjectId%%> F
(%%F G
id%%G I
)%%I J
;%%J K
return&& 
_needs&& 
.&& 
Find&& 
(&& 
need&& #
=>&&$ &
need&&' +
.&&+ ,
UserId&&, 2
==&&3 5
needsIds&&6 >
&&&&? A
need&&B F
.&&F G
State&&G L
!=&&M O
$str&&P V
)&&V W
.&&W X
ToList&&X ^
(&&^ _
)&&_ `
;&&` a
}'' 	
public)) 
List)) 
<)) 
Need)) 
>)) 
GetDoneNeedsByUser)) ,
()), -
string))- 3
id))4 6
)))6 7
{** 	
MongoDB++ 
.++ 
Bson++ 
.++ 
ObjectId++ !
needsIds++" *
=+++ ,
new++- 0
MongoDB++1 8
.++8 9
Bson++9 =
.++= >
ObjectId++> F
(++F G
id++G I
)++I J
;++J K
return,, 
_needs,, 
.,, 
Find,, 
(,, 
need,, #
=>,,$ &
need,,' +
.,,+ ,
UserId,,, 2
==,,3 5
needsIds,,6 >
&&,,? A
need,,B F
.,,F G
State,,G L
==,,M O
$str,,P V
),,V W
.,,W X
ToList,,X ^
(,,^ _
),,_ `
;,,` a
}-- 	
public00 
void00 

DeleteNeed00 
(00 
string00 %
id00& (
)00( )
{11 	
_needs22 
.22 
	DeleteOne22 
(22 
need22 !
=>22" $
need22% )
.22) *
Id22* ,
==22- /
id220 2
)222 3
;223 4
}33 	
public55 
void55 

UpdateNeed55 
(55 
string55 %
id55& (
,55( )
Need55* .
needIn55/ 5
)555 6
=>557 9
_needs66 
.66 
FindOneAndReplace66 $
(66$ %
need66% )
=>66* ,
need66- 1
.661 2
Id662 4
==665 7
id668 :
,66: ;
needIn66< B
)66B C
;66C D
}88 
}99 ⁄-
`F:\faculta\ANIII\Valean\GitHubProj\II_2020_Backend\backendapi\backendapi\Services\UserService.cs
	namespace 	

backendapi
 
. 
Services 
{ 
public 

class 
UserService 
{ 
private 
readonly 
IMongoCollection )
<) *
User* .
>. /
_users0 6
;6 7
public 
UserService 
( 
IDatabaseSettings ,
settings- 5
)5 6
{ 	
var 
client 
= 
new 
MongoClient (
(( )
settings) 1
.1 2
ConnectionString2 B
)B C
;C D
var 
database 
= 
client !
.! "
GetDatabase" -
(- .
settings. 6
.6 7
DatabaseName7 C
)C D
;D E
_users 
= 
database 
. 
GetCollection +
<+ ,
User, 0
>0 1
(1 2
settings2 :
.: ;
UserCollectionName; M
)M N
;N O
} 	
public 
List 
< 
User 
> 
Get 
( 
) 
=>  "
_users 
. 
Find 
( 
user 
=> 
true  $
)$ %
.% &
ToList& ,
(, -
)- .
;. /
public"" 
User"" 
Create"" 
("" 
User"" 
user""  $
)""$ %
{## 	
user%% 
.%% 
NeedsIds%% 
=%% 
new%% 
List%%  $
<%%$ %
MongoDB%%% ,
.%%, -
Bson%%- 1
.%%1 2
ObjectId%%2 :
>%%: ;
(%%; <
)%%< =
;%%= >
_users&& 
.&& 
	InsertOne&& 
(&& 
user&& !
)&&! "
;&&" #
return'' 
user'' 
;'' 
}(( 	
public** 
User** 
GetUserByEmail** "
(**" #
String**# )
email*** /
)**/ 0
=>**1 3
_users++ 
.++ 
Find++ 
(++ 
user++ 
=>++ 
user++  $
.++$ %
Email++% *
==+++ -
email++. 3
)++3 4
.++4 5
FirstOrDefault++5 C
(++C D
)++D E
;++E F
public.. 
User.. 
GetUser.. 
(.. 
string.. "
id..# %
)..% &
=>..' )
_users// 
.// 
Find// 
(// 
user// 
=>// 
user// #
.//# $
Id//$ &
==//' )
id//* ,
)//, -
.//- .
FirstOrDefault//. <
(//< =
)//= >
;//> ?
public11 
List11 
<11 
MongoDB11 
.11 
Bson11  
.11  !
ObjectId11! )
>11) *
GetUserNeedsIds11+ :
(11: ;
string11; A
id11B D
)11D E
=>11F H
_users22 
.22 
Find22 
(22 
user22 
=>22 
user22  $
.22$ %
Id22% '
==22( *
id22+ -
)22- .
.22. /
FirstOrDefault22/ =
(22= >
)22> ?
.22? @
NeedsIds22@ H
;22H I
public44 
void44 

UpdateUser44 
(44 
string44 %
id44& (
,44( )
User44* .
userIn44/ 5
)445 6
=>447 9
_users55 
.55 
FindOneAndReplace55 $
(55$ %
user55% )
=>55* ,
user55- 1
.551 2
Id552 4
==555 7
id558 :
,55: ;
userIn55< B
)55B C
;55C D
public77 
void77 
AssignUserNeed77 "
(77" #
string77# )
id77* ,
,77, -
ObjectId77. 6
nid777 :
,77: ;
User77< @
userIn77A G
)77G H
=>77I K
_users88 
.88 
FindOneAndReplace88 $
(88$ %
user88% )
=>88* ,
user88- 1
.881 2
Id882 4
==885 7
id888 :
,88: ;
userIn88< B
)88B C
;88C D
public:: 
User:: 
Login:: 
(:: 
string::  
email::! &
,::& '
string::( .
password::/ 7
)::7 8
=>::9 ;
_users;; 
.;; 
Find;; 
(;; 
user;; 
=>;; 
user;; #
.;;# $
Email;;$ )
==;;* ,
email;;- 2
&&;;3 5
user;;6 :
.;;: ;
Password;;; C
==;;D F
password;;G O
);;O P
.;;P Q
FirstOrDefault;;Q _
(;;_ `
);;` a
;;;a b
public== 
static== 
string== 
SerialGenerator== ,
(==, -
Object==- 3
objectToSerialize==4 E
)==E F
=>==G I
Convert>> 
.>> 
ToBase64String>> "
(>>" #
Encoding>># +
.>>+ ,
UTF8>>, 0
.>>0 1
GetBytes>>1 9
(>>9 :
JsonConvert>>: E
.>>E F
SerializeObject>>F U
(>>U V
objectToSerialize>>V g
)>>g h
)>>h i
)>>i j
;>>j k
}@@ 
}AA …!
SF:\faculta\ANIII\Valean\GitHubProj\II_2020_Backend\backendapi\backendapi\Startup.cs
	namespace 	

backendapi
 
{ 
public 

class 
Startup 
{ 
public 
Startup 
( 
IConfiguration %
configuration& 3
)3 4
{ 	
Configuration 
= 
configuration )
;) *
} 	
public 
IConfiguration 
Configuration +
{, -
get. 1
;1 2
}3 4
public 
void 
ConfigureServices %
(% &
IServiceCollection& 8
services9 A
)A B
{ 	
services   
.   
	Configure   
<   
DatabaseSettings   /
>  / 0
(  0 1
Configuration  1 >
.  > ?

GetSection  ? I
(  I J
nameof  J P
(  P Q
DatabaseSettings  Q a
)  a b
)  b c
)  c d
;  d e
services## 
.## 
AddSingleton## !
<##! "
IDatabaseSettings##" 3
>##3 4
(##4 5
sp##5 7
=>##8 :
sp$$ 
.$$ 
GetRequiredService$$ %
<$$% &
IOptions$$& .
<$$. /
DatabaseSettings$$/ ?
>$$? @
>$$@ A
($$A B
)$$B C
.$$C D
Value$$D I
)$$I J
;$$J K
services'' 
.'' 
AddSingleton'' !
<''! "
DonationsService''" 2
>''2 3
(''3 4
)''4 5
;''5 6
services(( 
.(( 
AddSingleton(( !
<((! "
UserService((" -
>((- .
(((. /
)((/ 0
;((0 1
services)) 
.)) 
AddSingleton)) !
<))! "
NeedService))" -
>))- .
()). /
)))/ 0
;))0 1
services-- 
.-- 
AddCors-- 
(-- 
options-- $
=>--% '
options--( /
.--/ 0
	AddPolicy--0 9
(--9 :
$str--: E
,--E F
builder--G N
=>--O Q
{.. 
builder// 
.// 
WithOrigins// #
(//# $
$str//$ 9
)//9 :
.//: ;
WithMethods//; F
(//F G
$str//G L
,//L M
$str//N S
,//S T
$str//U [
,//[ \
$str//] e
)//e f
.00 
AllowAnyHeader00 #
(00# $
)00$ %
.00% &
SetIsOriginAllowed00& 8
(008 9
(009 :
host00: >
)00> ?
=>00@ B
true00C G
)00G H
;00H I
}11 
)11 
)11 
;11 
services33 
.33 
AddControllers33 #
(33# $
)33$ %
;33% &
}44 	
public66 
void66 
	Configure66 
(66 
IApplicationBuilder66 1
app662 5
,665 6
IWebHostEnvironment667 J
env66K N
)66N O
{77 	
if88 
(88 
env88 
.88 
IsDevelopment88 !
(88! "
)88" #
)88# $
{99 
app:: 
.:: %
UseDeveloperExceptionPage:: -
(::- .
)::. /
;::/ 0
};; 
app== 
.== 
UseCors== 
(== 
$str== #
)==# $
;==$ %
app?? 
.?? 
UseHttpsRedirection?? #
(??# $
)??$ %
;??% &
appAA 
.AA 

UseRoutingAA 
(AA 
)AA 
;AA 
appCC 
.CC 
UseAuthorizationCC  
(CC  !
)CC! "
;CC" #
appEE 
.EE 
UseEndpointsEE 
(EE 
	endpointsEE &
=>EE' )
{FF 
	endpointsGG 
.GG 
MapControllersGG (
(GG( )
)GG) *
;GG* +
}HH 
)HH 
;HH 
}II 	
}JJ 
}KK –
WF:\faculta\ANIII\Valean\GitHubProj\II_2020_Backend\backendapi\backendapi\Utils\Utils.cs
	namespace 	

backendapi
 
. 
Utils 
{ 
public

 

static

 
class

 
Utils

 
{ 
public 
const 
string 
NEED_STATE_ASSIGNED /
=0 1
$str2 <
;< =
public 
const 
string !
NEED_STATE_UNASSIGNED 1
=2 3
$str4 @
;@ A
public 
const 
string 
NEED_STATE_DONE +
=, -
$str. 4
;4 5
} 
} 